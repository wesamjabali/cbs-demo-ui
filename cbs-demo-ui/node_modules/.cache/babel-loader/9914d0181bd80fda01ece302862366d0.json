{"remainingRequest":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/babel-loader/lib/index.js!/home/wesam/Code/CBS-official/cbs-ui/node_modules/eslint-loader/index.js??ref--13-0!/home/wesam/Code/CBS-official/cbs-ui/src/store/index.js","dependencies":[{"path":"/home/wesam/Code/CBS-official/cbs-ui/src/store/index.js","mtime":1600672600024},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvd2VzYW0vQ29kZS9DQlMtb2ZmaWNpYWwvY2JzLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgVnVleCBmcm9tICJ2dWV4IjsKaW1wb3J0IGp3dERlY29kZSBmcm9tICJqd3QtZGVjb2RlIjsKaW1wb3J0IGF4aW9zIGZyb20gIkAvcGx1Z2lucy9heGlvcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi4vcm91dGVyIjsKaW1wb3J0IGNyZWF0ZVBlcnNpc3RlZFN0YXRlIGZyb20gInZ1ZXgtcGVyc2lzdGVkc3RhdGUiOwpWdWUudXNlKFZ1ZXgpOwp2YXIgc3RhdGUgPSB7CiAgdG9rZW46ICIiLAogIHVzZXI6IHt9Cn07CnZhciBnZXR0ZXJzID0gewogIGlzTG9nZ2VkSW46IGZ1bmN0aW9uIGlzTG9nZ2VkSW4oc3RhdGUpIHsKICAgIHJldHVybiAhIXN0YXRlLnRva2VuOwogIH0sCiAgdXNlcm5hbWU6IGZ1bmN0aW9uIHVzZXJuYW1lKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUudXNlci51c2VybmFtZSB8fCAiIjsKICB9LAogIHJvbGVzOiBmdW5jdGlvbiByb2xlcyhzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLnVzZXIucm9sZXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgX3JlZjIpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBkaXNwYXRjaCwgdXNlcm5hbWUsIHBhc3N3b3JkLCBidWlsdFVSTCwgX3lpZWxkJGF4aW9zJHBvc3QsIF95aWVsZCRheGlvcyRwb3N0JGRhdCwgZGF0YSwgdG9rZW47CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoOwogICAgICAgICAgICAgIHVzZXJuYW1lID0gX3JlZjIudXNlcm5hbWUsIHBhc3N3b3JkID0gX3JlZjIucGFzc3dvcmQ7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgYnVpbHRVUkwgPSAiL2F1dGgvbG9naW4iOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KGJ1aWx0VVJMLCB7CiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfeWllbGQkYXhpb3MkcG9zdCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgX3lpZWxkJGF4aW9zJHBvc3QkZGF0ID0gX3lpZWxkJGF4aW9zJHBvc3QuZGF0YTsKICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJGF4aW9zJHBvc3QkZGF0ID09PSB2b2lkIDAgPyB7fSA6IF95aWVsZCRheGlvcyRwb3N0JGRhdDsKICAgICAgICAgICAgICB0b2tlbiA9IGRhdGEudG9rZW47CiAgICAgICAgICAgICAgZGlzcGF0Y2goInNldFVzZXIiLCB7CiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMzsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDIpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2dpbiAtPiBlcnIiLCBfY29udGV4dC50MCk7CiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQudDA7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzIsIDEzXV0pOwogICAgfSkpKCk7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChfcmVmMykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgIC8vIGNsZWFyIHVzZXIgYXV0aAogICAgZGVsZXRlIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLmF1dGhvcml6YXRpb247CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgidG9rZW4iKTsKICAgIGNvbW1pdCgiY2xlYXJVc2VyIik7CiAgICByb3V0ZXIucHVzaCgiLyIpOwogIH0sCiAgc2V0VXNlcjogZnVuY3Rpb24gc2V0VXNlcihfcmVmNCwgX3JlZjUpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICB2YXIgdG9rZW4gPSBfcmVmNS50b2tlbjsKICAgIC8vIGhhbmRsZSBheGlvcyBoZWFkZXIgdXBkYXRlCiAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5hdXRob3JpemF0aW9uID0gIkJlYXJlciAiICsgdG9rZW47IC8vIGhhbmRsZSBsb2NhbHN0b3JhZ2UgdXBkYXRlcwoKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHRva2VuKTsKICAgIHZhciB1c2VyID0gand0RGVjb2RlKHRva2VuKTsgLy8gY29tbWl0IHVzZXIgZGV0YWlscyB0byB2dWV4CgogICAgY29tbWl0KCJzZXRVc2VyIiwgewogICAgICB0b2tlbjogdG9rZW4sCiAgICAgIHVzZXI6IHVzZXIKICAgIH0pOwogIH0sCiAgaW5pdGlhbGl6ZUFwcDogZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcChfcmVmNikgewogICAgdmFyIGRpc3BhdGNoID0gX3JlZjYuZGlzcGF0Y2g7CiAgICAvLyBoYW5kbGUgbWFpbiBpbml0IGxvZ2ljCiAgICB2YXIgc3RvcmFnZVRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIikgfHwgIiI7CgogICAgaWYgKHN0b3JhZ2VUb2tlbikgewogICAgICB2YXIgdXNlciA9IGp3dERlY29kZShzdG9yYWdlVG9rZW4pOwogICAgICB2YXIgcmVtYWluaW5nVGltZSA9IHVzZXIuZXhwIC0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7IC8vIGNvbnNvbGUubG9nKCJUQ0w6IGluaXRpYWxpemVBcHAgLT4gcmVtYWluaW5nVGltZSIsIHJlbWFpbmluZ1RpbWUpOwogICAgICAvLyBJZiBpbml0aWFsaXplZCBhbmQgc3RvcmVkIHRva2VuIGhhcyBtb3JlIHRoYW4gMiBob3VycyBsZWZ0LCB1c2Ugc2FtZSB0b2tlbgogICAgICAvLyBvdGhlcndpc2UsIGF0dGVtcHQgcmVmcmVzaAoKICAgICAgaWYgKHJlbWFpbmluZ1RpbWUgPiA3MjAwKSB7CiAgICAgICAgLy8gaW5pdGlhbGl6ZSB1c2VyIGlmIHVzZXIgZXhpc3RzCiAgICAgICAgZGlzcGF0Y2goInNldFVzZXIiLCB7CiAgICAgICAgICB0b2tlbjogc3RvcmFnZVRva2VuCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07CnZhciBtdXRhdGlvbnMgPSB7CiAgc2V0VXNlcjogZnVuY3Rpb24gc2V0VXNlcihzdGF0ZSwgcGF5bG9hZCkgewogICAgc3RhdGUudG9rZW4gPSBwYXlsb2FkLnRva2VuOwogICAgc3RhdGUudXNlciA9IHBheWxvYWQudXNlcjsKICAgIHN0YXRlLnJvbGVzID0gcGF5bG9hZC51c2VyLnJvbGVzOwogICAgcmV0dXJuIHN0YXRlOwogIH0sCiAgY2xlYXJVc2VyOiBmdW5jdGlvbiBjbGVhclVzZXIoc3RhdGUpIHsKICAgIHN0YXRlLnRva2VuID0gIiI7CiAgICBzdGF0ZS51c2VyID0ge307CiAgICBzdGF0ZS5yb2xlcyA9IFtdOwogICAgcmV0dXJuIHN0YXRlOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgbmV3IFZ1ZXguU3RvcmUoewogIHN0YXRlOiBzdGF0ZSwKICBnZXR0ZXJzOiBnZXR0ZXJzLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMsCiAgcGx1Z2luczogW2NyZWF0ZVBlcnNpc3RlZFN0YXRlKCldCn0pOw=="},{"version":3,"sources":["/home/wesam/Code/CBS-official/cbs-ui/src/store/index.js"],"names":["Vue","Vuex","jwtDecode","axios","router","createPersistedState","use","state","token","user","getters","isLoggedIn","username","roles","actions","login","dispatch","password","builtURL","post","data","console","log","logout","commit","defaults","headers","common","authorization","localStorage","removeItem","push","setUser","setItem","initializeApp","storageToken","getItem","remainingTime","exp","Math","floor","Date","now","mutations","payload","clearUser","Store","plugins"],"mappings":"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","sourcesContent":["import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"@/plugins/axios\";\nimport router from \"../router\";\nimport createPersistedState from \"vuex-persistedstate\";\n\nVue.use(Vuex);\n\nconst state = {\n  token: \"\",\n  user: {}\n};\n\nconst getters = {\n  isLoggedIn: state => !!state.token,\n  username: state => state.user.username || \"\",\n  roles: state => state.user.roles\n};\n\nconst actions = {\n  async login({\n    dispatch\n  }, {\n    username,\n    password\n  }) {\n    try {\n      const builtURL = `/auth/login`;\n      const {\n        data = {}\n      } = await axios.post(builtURL, {\n        username,\n        password\n      });\n      const {\n        token\n      } = data;\n      dispatch(\"setUser\", {\n        token\n      });\n    } catch (err) {\n      console.log(\"login -> err\", err);\n      throw err;\n    }\n  },\n\n  logout({\n    commit\n  }) {\n    // clear user auth\n    delete axios.defaults.headers.common.authorization;\n    localStorage.removeItem(\"token\");\n    commit(\"clearUser\");\n    router.push(\"/\");\n  },\n\n  setUser({\n    commit\n  }, {\n    token\n  }) {\n    // handle axios header update\n    axios.defaults.headers.common.authorization = \"Bearer \" + token;\n    // handle localstorage updates\n    localStorage.setItem(\"token\", token);\n    const user = jwtDecode(token);\n    // commit user details to vuex\n    commit(\"setUser\", {\n      token,\n      user\n    });\n  },\n\n  initializeApp({\n    dispatch\n  }) {\n    // handle main init logic\n    const storageToken = localStorage.getItem(\"token\") || \"\";\n    if (storageToken) {\n      const user = jwtDecode(storageToken);\n      const remainingTime = user.exp - Math.floor(Date.now() / 1000);\n      // console.log(\"TCL: initializeApp -> remainingTime\", remainingTime);\n      // If initialized and stored token has more than 2 hours left, use same token\n      // otherwise, attempt refresh\n      if (remainingTime > 7200) {\n        // initialize user if user exists\n        dispatch(\"setUser\", {\n          token: storageToken\n        });\n      }\n    }\n  }\n};\n\nconst mutations = {\n  setUser: (state, payload) => {\n    state.token = payload.token;\n    state.user = payload.user;\n    state.roles = payload.user.roles;\n    return state;\n  },\n  clearUser: state => {\n    state.token = \"\";\n    state.user = {};\n    state.roles = [];\n    return state;\n  }\n};\n\nexport default new Vuex.Store({\n  state,\n  getters,\n  mutations,\n  actions,\n  plugins: [createPersistedState()]\n});"]}]}