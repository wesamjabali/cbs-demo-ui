{"remainingRequest":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js!/home/wesam/Code/CMS/cms-ui/node_modules/eslint-loader/index.js??ref--13-0!/home/wesam/Code/CMS/cms-ui/src/store/index.js","dependencies":[{"path":"/home/wesam/Code/CMS/cms-ui/src/store/index.js","mtime":1599009361919},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvd2VzYW0vQ29kZS9DTVMvY21zLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgVnVleCBmcm9tICJ2dWV4IjsKaW1wb3J0IGp3dERlY29kZSBmcm9tICJqd3QtZGVjb2RlIjsKaW1wb3J0IGF4aW9zIGZyb20gIkAvcGx1Z2lucy9heGlvcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi4vcm91dGVyIjsKaW1wb3J0IGNyZWF0ZVBlcnNpc3RlZFN0YXRlIGZyb20gInZ1ZXgtcGVyc2lzdGVkc3RhdGUiOwpWdWUudXNlKFZ1ZXgpOwp2YXIgc3RhdGUgPSB7CiAgdG9rZW46ICIiLAogIHVzZXI6IHt9Cn07CnZhciBnZXR0ZXJzID0gewogIGlzTG9nZ2VkSW46IGZ1bmN0aW9uIGlzTG9nZ2VkSW4oc3RhdGUpIHsKICAgIHJldHVybiAhIXN0YXRlLnRva2VuOwogIH0sCiAgdXNlcm5hbWU6IGZ1bmN0aW9uIHVzZXJuYW1lKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUudXNlci51c2VybmFtZSB8fCAiIjsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCBfcmVmMikgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGRpc3BhdGNoLCB1c2VybmFtZSwgcGFzc3dvcmQsIGJ1aWx0VVJMLCBfeWllbGQkYXhpb3MkcG9zdCwgX3lpZWxkJGF4aW9zJHBvc3QkZGF0LCBkYXRhLCB0b2tlbjsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBkaXNwYXRjaCA9IF9yZWYuZGlzcGF0Y2g7CiAgICAgICAgICAgICAgdXNlcm5hbWUgPSBfcmVmMi51c2VybmFtZSwgcGFzc3dvcmQgPSBfcmVmMi5wYXNzd29yZDsKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjsKICAgICAgICAgICAgICBidWlsdFVSTCA9ICIvYXV0aC9sb2dpbiI7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoYnVpbHRVUkwsIHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF95aWVsZCRheGlvcyRwb3N0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfeWllbGQkYXhpb3MkcG9zdCRkYXQgPSBfeWllbGQkYXhpb3MkcG9zdC5kYXRhOwogICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkYXhpb3MkcG9zdCRkYXQgPT09IHZvaWQgMCA/IHt9IDogX3lpZWxkJGF4aW9zJHBvc3QkZGF0OwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2dpbiAtPiBkYXRhIiwgZGF0YSk7CiAgICAgICAgICAgICAgdG9rZW4gPSBkYXRhLnRva2VuOwogICAgICAgICAgICAgIGRpc3BhdGNoKCJzZXRVc2VyIiwgewogICAgICAgICAgICAgICAgdG9rZW46IHRva2VuCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgyKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygibG9naW4gLT4gZXJyIiwgX2NvbnRleHQudDApOwogICAgICAgICAgICAgIHRocm93IF9jb250ZXh0LnQwOwoKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCAxNF1dKTsKICAgIH0pKSgpOwogIH0sCiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICAvLyBjbGVhciB1c2VyIGF1dGgKICAgIGRlbGV0ZSBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5hdXRob3JpemF0aW9uOwogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oInRva2VuIik7CiAgICByb3V0ZXIucHVzaCgiLyIpOwogICAgY29tbWl0KCJjbGVhclVzZXIiKTsKICB9LAogIHNldFVzZXI6IGZ1bmN0aW9uIHNldFVzZXIoX3JlZjQsIF9yZWY1KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgdmFyIHRva2VuID0gX3JlZjUudG9rZW47CiAgICAvLyBoYW5kbGUgYXhpb3MgaGVhZGVyIHVwZGF0ZQogICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb24uYXV0aG9yaXphdGlvbiA9ICJCZWFyZXIgIiArIHRva2VuOyAvLyBoYW5kbGUgbG9jYWxzdG9yYWdlIHVwZGF0ZXMKCiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCB0b2tlbik7CiAgICB2YXIgdXNlciA9IGp3dERlY29kZSh0b2tlbik7IC8vIGNvbW1pdCB1c2VyIGRldGFpbHMgdG8gdnVleAoKICAgIGNvbW1pdCgic2V0VXNlciIsIHsKICAgICAgdG9rZW46IHRva2VuLAogICAgICB1c2VyOiB1c2VyCiAgICB9KTsKICB9LAogIGluaXRpYWxpemVBcHA6IGZ1bmN0aW9uIGluaXRpYWxpemVBcHAoX3JlZjYpIHsKICAgIHZhciBkaXNwYXRjaCA9IF9yZWY2LmRpc3BhdGNoOwogICAgLy8gaGFuZGxlIG1haW4gaW5pdCBsb2dpYwogICAgdmFyIHN0b3JhZ2VUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpIHx8ICIiOwoKICAgIGlmIChzdG9yYWdlVG9rZW4pIHsKICAgICAgdmFyIHVzZXIgPSBqd3REZWNvZGUoc3RvcmFnZVRva2VuKTsKICAgICAgdmFyIHJlbWFpbmluZ1RpbWUgPSB1c2VyLmV4cCAtIE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApOyAvLyBjb25zb2xlLmxvZygiVENMOiBpbml0aWFsaXplQXBwIC0+IHJlbWFpbmluZ1RpbWUiLCByZW1haW5pbmdUaW1lKTsKICAgICAgLy8gSWYgaW5pdGlhbGl6ZWQgYW5kIHN0b3JlZCB0b2tlbiBoYXMgbW9yZSB0aGFuIDIgaG91cnMgbGVmdCwgdXNlIHNhbWUgdG9rZW4KICAgICAgLy8gb3RoZXJ3aXNlLCBhdHRlbXB0IHJlZnJlc2gKCiAgICAgIGlmIChyZW1haW5pbmdUaW1lID4gNzIwMCkgewogICAgICAgIC8vIGluaXRpYWxpemUgdXNlciBpZiB1c2VyIGV4aXN0cwogICAgICAgIGRpc3BhdGNoKCJzZXRVc2VyIiwgewogICAgICAgICAgdG9rZW46IHN0b3JhZ2VUb2tlbgogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9Owp2YXIgbXV0YXRpb25zID0gewogIHNldFVzZXI6IGZ1bmN0aW9uIHNldFVzZXIoc3RhdGUsIHBheWxvYWQpIHsKICAgIHN0YXRlLnRva2VuID0gcGF5bG9hZC50b2tlbjsKICAgIHN0YXRlLnVzZXIgPSBwYXlsb2FkLnVzZXI7CiAgICByZXR1cm4gc3RhdGU7CiAgfSwKICBjbGVhclVzZXI6IGZ1bmN0aW9uIGNsZWFyVXNlcihzdGF0ZSkgewogICAgc3RhdGUudG9rZW4gPSAiIjsKICAgIHN0YXRlLnVzZXIgPSB7fTsKICAgIHJldHVybiBzdGF0ZTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IG5ldyBWdWV4LlN0b3JlKHsKICBzdGF0ZTogc3RhdGUsCiAgZ2V0dGVyczogZ2V0dGVycywKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zLAogIHBsdWdpbnM6IFtjcmVhdGVQZXJzaXN0ZWRTdGF0ZSgpXQp9KTs="},{"version":3,"sources":["/home/wesam/Code/CMS/cms-ui/src/store/index.js"],"names":["Vue","Vuex","jwtDecode","axios","router","createPersistedState","use","state","token","user","getters","isLoggedIn","username","actions","login","dispatch","password","builtURL","post","data","console","log","logout","commit","defaults","headers","common","authorization","localStorage","removeItem","push","setUser","setItem","initializeApp","storageToken","getItem","remainingTime","exp","Math","floor","Date","now","mutations","payload","clearUser","Store","plugins"],"mappings":"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","sourcesContent":["import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"@/plugins/axios\";\nimport router from \"../router\";\nimport createPersistedState from \"vuex-persistedstate\";\n\nVue.use(Vuex);\n\nconst state = {\n  token: \"\",\n  user: {}\n};\n\nconst getters = {\n  isLoggedIn: state => !!state.token,\n  username: state => state.user.username || \"\"\n};\n\nconst actions = {\n  async login({ dispatch }, { username, password }) {\n    try {\n      const builtURL = `/auth/login`;\n      const { data = {} } = await axios.post(builtURL, {\n        username,\n        password\n      });\n      console.log(\"login -> data\", data);\n      const { token } = data;\n      dispatch(\"setUser\", { token });\n    } catch (err) {\n      console.log(\"login -> err\", err);\n      throw err;\n    }\n  },\n\n  logout({ commit }) {\n    // clear user auth\n    delete axios.defaults.headers.common.authorization;\n    localStorage.removeItem(\"token\");\n    router.push(\"/\");\n    commit(\"clearUser\");\n  },\n\n  setUser({ commit }, { token }) {\n    // handle axios header update\n    axios.defaults.headers.common.authorization = \"Bearer \" + token;\n    // handle localstorage updates\n    localStorage.setItem(\"token\", token);\n    const user = jwtDecode(token);\n    // commit user details to vuex\n    commit(\"setUser\", { token, user });\n  },\n\n  initializeApp({ dispatch }) {\n    // handle main init logic\n    const storageToken = localStorage.getItem(\"token\") || \"\";\n    if (storageToken) {\n      const user = jwtDecode(storageToken);\n      const remainingTime = user.exp - Math.floor(Date.now() / 1000);\n      // console.log(\"TCL: initializeApp -> remainingTime\", remainingTime);\n      // If initialized and stored token has more than 2 hours left, use same token\n      // otherwise, attempt refresh\n      if (remainingTime > 7200) {\n        // initialize user if user exists\n        dispatch(\"setUser\", { token: storageToken });\n      }\n    }\n  }\n};\n\nconst mutations = {\n  setUser: (state, payload) => {\n    state.token = payload.token;\n    state.user = payload.user;\n    return state;\n  },\n  clearUser: state => {\n    state.token = \"\";\n    state.user = {};\n    return state;\n  }\n};\n\nexport default new Vuex.Store({\n  state,\n  getters,\n  mutations,\n  actions,\n  plugins: [createPersistedState()],\n});\n"]}]}