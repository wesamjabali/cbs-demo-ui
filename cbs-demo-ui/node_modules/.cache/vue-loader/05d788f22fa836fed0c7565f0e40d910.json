{"remainingRequest":"/home/wesam/Code/CMS/cms-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wesam/Code/CMS/cms-ui/src/views/Clock.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wesam/Code/CMS/cms-ui/src/views/Clock.vue","mtime":1599183047659},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gImxvZGFzaCI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2xvY2siLAogIGNvbXB1dGVkOiB7CiAgICBpc0xvZ2dlZEluKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5pc0xvZ2dlZEluOwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNsb2NrU3RhdHVzOiAiIiwKICAgICAgcHVuY2hEYXRhOiBbXSwKICAgICAgc2VhcmNoOiAiIiwKICAgICAgaGVhZGVyczogWwogICAgICAgIHsKICAgICAgICAgIHRleHQ6ICJJRCIsCiAgICAgICAgICBhbGlnbjogInN0YXJ0IiwKICAgICAgICAgIHZhbHVlOiAiaWQiLAogICAgICAgICAgZ3JvdXBhYmxlOiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgeyB0ZXh0OiAiSW4gVGltZSIsIHZhbHVlOiAiaW50aW1lIiwgZ3JvdXBhYmxlOiBmYWxzZSB9LAogICAgICAgIHsgdGV4dDogIk91dCBUaW1lIiwgdmFsdWU6ICJvdXR0aW1lIiwgZ3JvdXBhYmxlOiBmYWxzZSB9LAogICAgICAgIHsgdGV4dDogIkRhdGUiLCB2YWx1ZTogImRhdGUiIH0sCiAgICAgICAgeyB0ZXh0OiAiSG91cnMiLCB2YWx1ZTogImhvdXJzIiwgZ3JvdXBhYmxlOiBmYWxzZSB9CiAgICAgIF0KICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRTZXNzaW9ucygpOwogICAgdGhpcy5nZXRDbG9ja1N0YXR1cygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0U2Vzc2lvbnMoKSB7CiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgdGhpcy4kYXhpb3MuZ2V0KCJhY2NvdW50L2Nsb2NrL2dldFNlc3Npb25zIik7CiAgICAgIF8uZm9yRWFjaChzZXNzaW9ucy5kYXRhLCAoc2Vzc2lvbikgPT4gewogICAgICAgIHNlc3Npb24uZGF0ZSA9IG1vbWVudChzZXNzaW9uLmludGltZSkuZm9ybWF0KCJkZGRkLCBNTU0gRG8gWVlZWSIpOwoKICAgICAgICB2YXIgaG91cnM7CiAgICAgICAgaWYoc2Vzc2lvbi5vdXR0aW1lKSB7CiAgICAgICAgICBob3VycyA9IG1vbWVudChzZXNzaW9uLm91dHRpbWUpLmRpZmYobW9tZW50KHNlc3Npb24uaW50aW1lKSwgJ2hvdXJzJywgdHJ1ZSkKICAgICAgICAgICAgLnRvRml4ZWQoMik7CiAgICAgICAgICBzZXNzaW9uLm91dHRpbWUgPSBtb21lbnQoc2Vzc2lvbi5vdXR0aW1lKS5mb3JtYXQoImhoOm1tOnNzIEEiKQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2Vzc2lvbi5vdXR0aW1lID0gIiIKICAgICAgICB9CiAgICAgICAgICBzZXNzaW9uLmhvdXJzID0gaG91cnMKICAgICAgICAgIHNlc3Npb24uaW50aW1lID0gbW9tZW50KHNlc3Npb24uaW50aW1lKS5mb3JtYXQoImhoOm1tOnNzIEEiKTsKICAgICAgfSkKCiAgICAgIHRoaXMucHVuY2hEYXRhID0gc2Vzc2lvbnMuZGF0YTsKICAgIH0sCiAgICBnZXRCdXR0b25UZXh0KCkgewogICAgICBpZih0aGlzLmNsb2NrU3RhdHVzID09ICdpbicpIHJldHVybiAiQ2xvY2sgT3V0IjsKICAgICAgZWxzZSByZXR1cm4gIkNsb2NrIEluIjsKICAgIH0sCiAgICBhc3luYyBnZXRDbG9ja1N0YXR1cygpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB7IGRhdGEgPSB7fSB9ID0gYXdhaXQgdGhpcy4kYXhpb3MuZ2V0KCIvYWNjb3VudC9jbG9jay9zdGF0dXMiKTsKICAgICAgICBjb25zdCBjbG9ja1N0YXR1cyA9IGRhdGE7CiAgICAgICAgdGhpcy5jbG9ja1N0YXR1cyA9IGNsb2NrU3RhdHVzOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCJnZXRDbG9ja1N0YXR1cyAtPiBlcnJvciIsIGVycm9yKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBwdW5jaENsb2NrKCkgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuJGF4aW9zLnBvc3QoIi9hY2NvdW50L2Nsb2NrL3B1bmNoIik7CiAgICAgICAgdGhpcy5nZXRDbG9ja1N0YXR1cygpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCJwdW5jaENsb2NrIC0+IGVycm9yIiwgZXJyb3IpOwogICAgICB9CiAgICAgIHRoaXMuZ2V0U2Vzc2lvbnMoKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Clock.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Clock.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <v-row class=\"justify-center\">\n    <v-col cols=\"12\">\n      <div>\n        <v-data-table\n          :headers=\"headers\"\n          :items=\"punchData\"\n          item-key=\"id\"\n          :sortBy=\"['id']\"\n          :sort-desc=\"[true]\"\n          :search=\"search\"\n          :mobile-breakpoint=\"0\"\n          multi-sort\n          height=\"50vh\"\n          fixed-header\n          hide-default-footer\n          show-group-by\n          :items-per-page=\"200\"\n          dense\n        ></v-data-table>\n      </div>\n      <div>\n        <v-card-text>\n          <v-text-field\n            v-model=\"search\"\n            append-icon=\"mdi-magnify\"\n            label=\"Search\"\n            single-line\n            hide-details\n          ></v-text-field>\n        </v-card-text>\n      </div>\n      <div class=\"d-flex\">\n        <v-btn\n          width=\"50%\"\n          @click=\"punchClock()\"\n          x-large\n          color=\"primary\"\n          class=\"mx-auto\"\n        >\n          {{ getButtonText() }}\n        </v-btn>\n      </div>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport _ from \"lodash\";\nimport moment from \"moment\";\n\nexport default {\n  name: \"Clock\",\n  computed: {\n    isLoggedIn() {\n      return this.$store.getters.isLoggedIn;\n    }\n  },\n  data() {\n    return {\n      clockStatus: \"\",\n      punchData: [],\n      search: \"\",\n      headers: [\n        {\n          text: \"ID\",\n          align: \"start\",\n          value: \"id\",\n          groupable: false\n        },\n        { text: \"In Time\", value: \"intime\", groupable: false },\n        { text: \"Out Time\", value: \"outtime\", groupable: false },\n        { text: \"Date\", value: \"date\" },\n        { text: \"Hours\", value: \"hours\", groupable: false }\n      ]\n    };\n  },\n  mounted() {\n    this.getSessions();\n    this.getClockStatus();\n  },\n  methods: {\n    async getSessions() {\n      const sessions = await this.$axios.get(\"account/clock/getSessions\");\n      _.forEach(sessions.data, (session) => {\n        session.date = moment(session.intime).format(\"dddd, MMM Do YYYY\");\n\n        var hours;\n        if(session.outtime) {\n          hours = moment(session.outtime).diff(moment(session.intime), 'hours', true)\n            .toFixed(2);\n          session.outtime = moment(session.outtime).format(\"hh:mm:ss A\")\n\n        } else {\n          session.outtime = \"\"\n        }\n          session.hours = hours\n          session.intime = moment(session.intime).format(\"hh:mm:ss A\");\n      })\n\n      this.punchData = sessions.data;\n    },\n    getButtonText() {\n      if(this.clockStatus == 'in') return \"Clock Out\";\n      else return \"Clock In\";\n    },\n    async getClockStatus() {\n      try {\n        const { data = {} } = await this.$axios.get(\"/account/clock/status\");\n        const clockStatus = data;\n        this.clockStatus = clockStatus;\n      } catch (error) {\n        console.log(\"getClockStatus -> error\", error);\n      }\n    },\n\n    async punchClock() {\n      try {\n        await this.$axios.post(\"/account/clock/punch\");\n        this.getClockStatus();\n      } catch (error) {\n        console.log(\"punchClock -> error\", error);\n      }\n      this.getSessions();\n    }\n  }\n};\n</script>\n"]}]}