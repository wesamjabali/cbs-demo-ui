{"remainingRequest":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js!/home/wesam/Code/CMS/cms-ui/node_modules/eslint-loader/index.js??ref--13-0!/home/wesam/Code/CMS/cms-ui/src/store/index.js","dependencies":[{"path":"/home/wesam/Code/CMS/cms-ui/src/store/index.js","mtime":1599437682739},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvd2VzYW0vQ29kZS9DTVMvY21zLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgVnVleCBmcm9tICJ2dWV4IjsKaW1wb3J0IGp3dERlY29kZSBmcm9tICJqd3QtZGVjb2RlIjsKaW1wb3J0IGF4aW9zIGZyb20gIkAvcGx1Z2lucy9heGlvcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi4vcm91dGVyIjsKaW1wb3J0IGNyZWF0ZVBlcnNpc3RlZFN0YXRlIGZyb20gInZ1ZXgtcGVyc2lzdGVkc3RhdGUiOwpWdWUudXNlKFZ1ZXgpOwp2YXIgc3RhdGUgPSB7CiAgdG9rZW46ICIiLAogIHVzZXI6IHt9Cn07CnZhciBnZXR0ZXJzID0gewogIGlzTG9nZ2VkSW46IGZ1bmN0aW9uIGlzTG9nZ2VkSW4oc3RhdGUpIHsKICAgIHJldHVybiAhIXN0YXRlLnRva2VuOwogIH0sCiAgdXNlcm5hbWU6IGZ1bmN0aW9uIHVzZXJuYW1lKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUudXNlci51c2VybmFtZSB8fCAiIjsKICB9LAogIHJvbGVzOiBmdW5jdGlvbiByb2xlcyhzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLnVzZXIucm9sZXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgX3JlZjIpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBkaXNwYXRjaCwgdXNlcm5hbWUsIHBhc3N3b3JkLCBidWlsdFVSTCwgX3lpZWxkJGF4aW9zJHBvc3QsIF95aWVsZCRheGlvcyRwb3N0JGRhdCwgZGF0YSwgdG9rZW47CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoOwogICAgICAgICAgICAgIHVzZXJuYW1lID0gX3JlZjIudXNlcm5hbWUsIHBhc3N3b3JkID0gX3JlZjIucGFzc3dvcmQ7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgYnVpbHRVUkwgPSAiL2F1dGgvbG9naW4iOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KGJ1aWx0VVJMLCB7CiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfeWllbGQkYXhpb3MkcG9zdCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgX3lpZWxkJGF4aW9zJHBvc3QkZGF0ID0gX3lpZWxkJGF4aW9zJHBvc3QuZGF0YTsKICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJGF4aW9zJHBvc3QkZGF0ID09PSB2b2lkIDAgPyB7fSA6IF95aWVsZCRheGlvcyRwb3N0JGRhdDsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygibG9naW4gLT4gZGF0YSIsIGRhdGEpOwogICAgICAgICAgICAgIHRva2VuID0gZGF0YS50b2tlbjsKICAgICAgICAgICAgICBkaXNwYXRjaCgic2V0VXNlciIsIHsKICAgICAgICAgICAgICAgIHRva2VuOiB0b2tlbgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE0OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coImxvZ2luIC0+IGVyciIsIF9jb250ZXh0LnQwKTsKICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dC50MDsKCiAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMiwgMTRdXSk7CiAgICB9KSkoKTsKICB9LAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0OwogICAgLy8gY2xlYXIgdXNlciBhdXRoCiAgICBkZWxldGUgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb24uYXV0aG9yaXphdGlvbjsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ0b2tlbiIpOwogICAgY29tbWl0KCJjbGVhclVzZXIiKTsKICAgIHJvdXRlci5wdXNoKCIvIik7CiAgfSwKICBzZXRVc2VyOiBmdW5jdGlvbiBzZXRVc2VyKF9yZWY0LCBfcmVmNSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHZhciB0b2tlbiA9IF9yZWY1LnRva2VuOwogICAgLy8gaGFuZGxlIGF4aW9zIGhlYWRlciB1cGRhdGUKICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLmF1dGhvcml6YXRpb24gPSAiQmVhcmVyICIgKyB0b2tlbjsgLy8gaGFuZGxlIGxvY2Fsc3RvcmFnZSB1cGRhdGVzCgogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRva2VuIiwgdG9rZW4pOwogICAgdmFyIHVzZXIgPSBqd3REZWNvZGUodG9rZW4pOyAvLyBjb21taXQgdXNlciBkZXRhaWxzIHRvIHZ1ZXgKCiAgICBjb21taXQoInNldFVzZXIiLCB7CiAgICAgIHRva2VuOiB0b2tlbiwKICAgICAgdXNlcjogdXNlcgogICAgfSk7CiAgfSwKICBpbml0aWFsaXplQXBwOiBmdW5jdGlvbiBpbml0aWFsaXplQXBwKF9yZWY2KSB7CiAgICB2YXIgZGlzcGF0Y2ggPSBfcmVmNi5kaXNwYXRjaDsKICAgIC8vIGhhbmRsZSBtYWluIGluaXQgbG9naWMKICAgIHZhciBzdG9yYWdlVG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKSB8fCAiIjsKCiAgICBpZiAoc3RvcmFnZVRva2VuKSB7CiAgICAgIHZhciB1c2VyID0gand0RGVjb2RlKHN0b3JhZ2VUb2tlbik7CiAgICAgIHZhciByZW1haW5pbmdUaW1lID0gdXNlci5leHAgLSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsgLy8gY29uc29sZS5sb2coIlRDTDogaW5pdGlhbGl6ZUFwcCAtPiByZW1haW5pbmdUaW1lIiwgcmVtYWluaW5nVGltZSk7CiAgICAgIC8vIElmIGluaXRpYWxpemVkIGFuZCBzdG9yZWQgdG9rZW4gaGFzIG1vcmUgdGhhbiAyIGhvdXJzIGxlZnQsIHVzZSBzYW1lIHRva2VuCiAgICAgIC8vIG90aGVyd2lzZSwgYXR0ZW1wdCByZWZyZXNoCgogICAgICBpZiAocmVtYWluaW5nVGltZSA+IDcyMDApIHsKICAgICAgICAvLyBpbml0aWFsaXplIHVzZXIgaWYgdXNlciBleGlzdHMKICAgICAgICBkaXNwYXRjaCgic2V0VXNlciIsIHsKICAgICAgICAgIHRva2VuOiBzdG9yYWdlVG9rZW4KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTsKdmFyIG11dGF0aW9ucyA9IHsKICBzZXRVc2VyOiBmdW5jdGlvbiBzZXRVc2VyKHN0YXRlLCBwYXlsb2FkKSB7CiAgICBzdGF0ZS50b2tlbiA9IHBheWxvYWQudG9rZW47CiAgICBzdGF0ZS51c2VyID0gcGF5bG9hZC51c2VyOwogICAgc3RhdGUucm9sZXMgPSBwYXlsb2FkLnVzZXIucm9sZXM7CiAgICByZXR1cm4gc3RhdGU7CiAgfSwKICBjbGVhclVzZXI6IGZ1bmN0aW9uIGNsZWFyVXNlcihzdGF0ZSkgewogICAgc3RhdGUudG9rZW4gPSAiIjsKICAgIHN0YXRlLnVzZXIgPSB7fTsKICAgIHN0YXRlLnJvbGVzID0gW107CiAgICByZXR1cm4gc3RhdGU7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCBuZXcgVnVleC5TdG9yZSh7CiAgc3RhdGU6IHN0YXRlLAogIGdldHRlcnM6IGdldHRlcnMsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucywKICBwbHVnaW5zOiBbY3JlYXRlUGVyc2lzdGVkU3RhdGUoKV0KfSk7"},{"version":3,"sources":["/home/wesam/Code/CMS/cms-ui/src/store/index.js"],"names":["Vue","Vuex","jwtDecode","axios","router","createPersistedState","use","state","token","user","getters","isLoggedIn","username","roles","actions","login","dispatch","password","builtURL","post","data","console","log","logout","commit","defaults","headers","common","authorization","localStorage","removeItem","push","setUser","setItem","initializeApp","storageToken","getItem","remainingTime","exp","Math","floor","Date","now","mutations","payload","clearUser","Store","plugins"],"mappings":"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","sourcesContent":["import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"@/plugins/axios\";\nimport router from \"../router\";\nimport createPersistedState from \"vuex-persistedstate\";\n\nVue.use(Vuex);\n\nconst state = {\n  token: \"\",\n  user: {}\n};\n\nconst getters = {\n  isLoggedIn: state => !!state.token,\n  username: state => state.user.username || \"\",\n  roles: state => state.user.roles\n};\n\nconst actions = {\n  async login({ dispatch }, { username, password }) {\n    try {\n      const builtURL = `/auth/login`;\n      const { data = {} } = await axios.post(builtURL, {\n        username,\n        password\n      });\n      console.log(\"login -> data\", data);\n      const { token } = data;\n      dispatch(\"setUser\", { token });\n    } catch (err) {\n      console.log(\"login -> err\", err);\n      throw err;\n    }\n  },\n\n  logout({ commit }) {\n    // clear user auth\n    delete axios.defaults.headers.common.authorization;\n    localStorage.removeItem(\"token\");\n    commit(\"clearUser\");\n    router.push(\"/\");\n  },\n\n  setUser({ commit }, { token }) {\n    // handle axios header update\n    axios.defaults.headers.common.authorization = \"Bearer \" + token;\n    // handle localstorage updates\n    localStorage.setItem(\"token\", token);\n    const user = jwtDecode(token);\n    // commit user details to vuex\n    commit(\"setUser\", { token, user });\n  },\n\n  initializeApp({ dispatch }) {\n    // handle main init logic\n    const storageToken = localStorage.getItem(\"token\") || \"\";\n    if (storageToken) {\n      const user = jwtDecode(storageToken);\n      const remainingTime = user.exp - Math.floor(Date.now() / 1000);\n      // console.log(\"TCL: initializeApp -> remainingTime\", remainingTime);\n      // If initialized and stored token has more than 2 hours left, use same token\n      // otherwise, attempt refresh\n      if (remainingTime > 7200) {\n        // initialize user if user exists\n        dispatch(\"setUser\", { token: storageToken });\n      }\n    }\n  }\n};\n\nconst mutations = {\n  setUser: (state, payload) => {\n    state.token = payload.token;\n    state.user = payload.user;\n    state.roles = payload.user.roles;\n    return state;\n  },\n  clearUser: state => {\n    state.token = \"\";\n    state.user = {};\n    state.roles = [];\n    return state;\n  }\n};\n\nexport default new Vuex.Store({\n  state,\n  getters,\n  mutations,\n  actions,\n  plugins: [createPersistedState()]\n});\n"]}]}