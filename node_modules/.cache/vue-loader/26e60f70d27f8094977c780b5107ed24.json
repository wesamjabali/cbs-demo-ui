{"remainingRequest":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wesam/Code/CBS-official/cbs-ui/src/views/Clock.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wesam/Code/CBS-official/cbs-ui/src/views/Clock.vue","mtime":1600758804680},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CBS-official/cbs-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2xvY2snLAogIGNvbXB1dGVkOiB7CiAgICBpc0xvZ2dlZEluKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5pc0xvZ2dlZEluOwogICAgfSwKICAgIHBheVBlcmlvZEVuZCgpIHsKICAgICAgcmV0dXJuIG1vbWVudCh0aGlzLnBheVBlcmlvZEJlZ2luKQogICAgICAgIC5hZGQoMiwgJ3dlZWtzJykKICAgICAgICAuc3VidHJhY3QoMSwgJ3NlY29uZCcpCiAgICAgICAgLnRvRGF0ZSgpOwogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjbG9ja1N0YXR1czogJycsCiAgICAgIHB1bmNoRGF0YTogW10sCiAgICAgIHRhYmxlTG9hZGluZzogdHJ1ZSwKICAgICAgYnV0dG9uc0xvYWRpbmc6IHRydWUsCiAgICAgIG9yaWdpblBheVBlcmlvZEJlZ2luOiBuZXcgRGF0ZSgnU2VwdGVtYmVyIDUsIDIwMjAgMDA6MDA6MDAnKSwKICAgICAgcGF5UGVyaW9kQmVnaW46IG51bGwsCiAgICAgIHBheVBlcmlvZE51bWJlcjogMCwKICAgICAgYW1vdW50RWFybmVkOiAwLAogICAgICBsYXRlc3RQYXlQZXJpb2Q6IDAsCiAgICAgIGhlYWRlcnM6IFsKICAgICAgICB7IHRleHQ6ICdJbiBUaW1lJywgdmFsdWU6ICdpbnRpbWUnLCBncm91cGFibGU6IGZhbHNlIH0sCiAgICAgICAgeyB0ZXh0OiAnT3V0IFRpbWUnLCB2YWx1ZTogJ291dHRpbWUnLCBncm91cGFibGU6IGZhbHNlIH0sCiAgICAgICAgeyB0ZXh0OiAnRGF0ZScsIHZhbHVlOiAnZGF0ZScsIGdyb3VwYWJsZTogZmFsc2UgfSwKICAgICAgICB7IHRleHQ6ICdIb3VycycsIHZhbHVlOiAnaG91cnMnLCBncm91cGFibGU6IGZhbHNlIH0sCiAgICAgIF0sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0Q2xvY2tTdGF0dXMoKTsKICAgIHRoaXMuZ2V0Q3VycmVudFBheVBlcmlvZCgpOwogIH0sCiAgd2F0Y2g6IHsKICAgIGFzeW5jIHBheVBlcmlvZEVuZCgpIHsKICAgICAgYXdhaXQgdGhpcy5nZXRTZXNzaW9ucygpOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldEN1cnJlbnRQYXlQZXJpb2QoKSB7CiAgICAgIHRoaXMucGF5UGVyaW9kQmVnaW4gPSBtb21lbnQoCiAgICAgICAgdGhpcy5vcmlnaW5QYXlQZXJpb2RCZWdpbiwKICAgICAgKS50b0RhdGUoKTsKICAgICAgbGV0IG5vdyA9IG1vbWVudCgpOwogICAgICB0aGlzLnBheVBlcmlvZE51bWJlciA9IE1hdGguZmxvb3IoCiAgICAgICAgbW9tZW50CiAgICAgICAgICAuZHVyYXRpb24obm93LmRpZmYobW9tZW50KHRoaXMub3JpZ2luUGF5UGVyaW9kQmVnaW4pKSkKICAgICAgICAgIC5hc1dlZWtzKCkgLyAyLAogICAgICApOwogICAgICB0aGlzLmxhdGVzdFBheVBlcmlvZCA9IHRoaXMucGF5UGVyaW9kTnVtYmVyOwoKICAgICAgdGhpcy5nb1RvUGF5UGVyaW9kKHRoaXMubGF0ZXN0UGF5UGVyaW9kKTsKCiAgICAgIHRoaXMudGFibGVMb2FkaW5nID0gZmFsc2U7CiAgICB9LAogICAgbmV4dFBheVBlcmlvZCgpIHsKICAgICAgdGhpcy5wYXlQZXJpb2ROdW1iZXIrKzsKICAgICAgdGhpcy5wYXlQZXJpb2RCZWdpbiA9IG1vbWVudCh0aGlzLm9yaWdpblBheVBlcmlvZEJlZ2luKQogICAgICAgIC5hZGQoMiAqIHRoaXMucGF5UGVyaW9kTnVtYmVyLCAnd2Vla3MnKQogICAgICAgIC50b0RhdGUoKTsKICAgIH0sCiAgICBwcmV2UGF5UGVyaW9kKCkgewogICAgICB0aGlzLnBheVBlcmlvZE51bWJlci0tOwogICAgICB0aGlzLnBheVBlcmlvZEJlZ2luID0gbW9tZW50KHRoaXMub3JpZ2luUGF5UGVyaW9kQmVnaW4pCiAgICAgICAgLmFkZCgyICogdGhpcy5wYXlQZXJpb2ROdW1iZXIsICd3ZWVrcycpCiAgICAgICAgLnRvRGF0ZSgpOwogICAgfSwKICAgIGdvVG9QYXlQZXJpb2QoZ290byA9IHRoaXMubGF0ZXN0UGF5UGVyaW9kKSB7CiAgICAgIHRoaXMucGF5UGVyaW9kTnVtYmVyID0gZ290bzsKICAgICAgdGhpcy5wYXlQZXJpb2RCZWdpbiA9IG1vbWVudCh0aGlzLm9yaWdpblBheVBlcmlvZEJlZ2luKQogICAgICAgIC5hZGQoMiAqIHRoaXMucGF5UGVyaW9kTnVtYmVyLCAnd2Vla3MnKQogICAgICAgIC50b0RhdGUoKTsKICAgIH0sCiAgICBhc3luYyBnZXRTZXNzaW9ucygpIHsKICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCB0aGlzLiRheGlvcy5nZXQoCiAgICAgICAgJ2FjY291bnQvY2xvY2svZ2V0U2Vzc2lvbnMnLAogICAgICAgIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBwYXlQZXJpb2RCZWdpbjogdGhpcy5wYXlQZXJpb2RCZWdpbiwKICAgICAgICAgICAgcGF5UGVyaW9kRW5kOiB0aGlzLnBheVBlcmlvZEVuZCwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgKTsKICAgICAgdGhpcy5hbW91bnRFYXJuZWQgPSAwOwogICAgICBfLmZvckVhY2goc2Vzc2lvbnMuZGF0YSwgc2Vzc2lvbiA9PiB7CiAgICAgICAgc2Vzc2lvbi5kYXRlT2JqSW4gPSBzZXNzaW9uLmludGltZTsKICAgICAgICBzZXNzaW9uLmRhdGUgPSBtb21lbnQoc2Vzc2lvbi5pbnRpbWUpLmZvcm1hdCgKICAgICAgICAgICdkZGRkLCBNTU0gRG8gWVlZWScsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKHNlc3Npb24ub3V0dGltZSkgewogICAgICAgICAgc2Vzc2lvbi5vdXR0aW1lID0gbW9tZW50KHNlc3Npb24ub3V0dGltZSkuZm9ybWF0KAogICAgICAgICAgICAnaGg6bW06c3MgQScsCiAgICAgICAgICApOwogICAgICAgICAgbGV0IGNvbXB1dGVkSG91cnMgPSBuZXcgRGF0ZShudWxsKTsKICAgICAgICAgIGNvbXB1dGVkSG91cnMuc2V0U2Vjb25kcyhzZXNzaW9uLnNlY29uZHN3b3JrZWQpOwogICAgICAgICAgc2Vzc2lvbi5ob3VycyA9IGNvbXB1dGVkSG91cnMudG9JU09TdHJpbmcoKS5zdWJzdHIoMTEsIDgpOwogICAgICAgICAgdGhpcy5hbW91bnRFYXJuZWQgKz0KICAgICAgICAgICAgKHNlc3Npb24uc2Vjb25kc3dvcmtlZCAvIDM2MDApICogc2Vzc2lvbi5wYXlyYXRlOwogICAgICAgIH0KICAgICAgICBzZXNzaW9uLmludGltZSA9IG1vbWVudChzZXNzaW9uLmludGltZSkuZm9ybWF0KCdoaDptbTpzcyBBJyk7CiAgICAgIH0pOwoKICAgICAgdGhpcy5wdW5jaERhdGEgPSBzZXNzaW9ucy5kYXRhOwogICAgfSwKICAgIGFzeW5jIGdldENsb2NrU3RhdHVzKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHsgZGF0YSA9IHt9IH0gPSBhd2FpdCB0aGlzLiRheGlvcy5nZXQoCiAgICAgICAgICAnL2FjY291bnQvY2xvY2svc3RhdHVzJywKICAgICAgICApOwogICAgICAgIGNvbnN0IGNsb2NrU3RhdHVzID0gZGF0YTsKICAgICAgICB0aGlzLmNsb2NrU3RhdHVzID0gY2xvY2tTdGF0dXM7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coJ2dldENsb2NrU3RhdHVzIC0+IGVycm9yJywgZXJyb3IpOwogICAgICB9CiAgICAgIHRoaXMuYnV0dG9uc0xvYWRpbmcgPSBmYWxzZTsKICAgIH0sCgogICAgYXN5bmMgcHVuY2hDbG9jaygpIHsKICAgICAgdGhpcy5idXR0b25zTG9hZGluZyA9IHRydWU7CgogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuJGF4aW9zLnBvc3QoJy9hY2NvdW50L2Nsb2NrL3B1bmNoJyk7CiAgICAgICAgdGhpcy5nZXRDbG9ja1N0YXR1cygpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCdwdW5jaENsb2NrIC0+IGVycm9yJywgZXJyb3IpOwogICAgICB9CiAgICAgIHRoaXMuZ2V0Q3VycmVudFBheVBlcmlvZCgpOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Clock.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Clock.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <v-row class=\"justify-center\">\n    <v-col cols=\"12\">\n      <div>\n        <v-data-table\n          :loading=\"tableLoading\"\n          :items=\"tableLoading ? [{}] : punchData\"\n          class=\"elevation-1\"\n          :headers=\"headers\"\n          item-key=\"id\"\n          :sortBy=\"['dateObjIn']\"\n          :sort-desc=\"[true]\"\n          :mobile-breakpoint=\"0\"\n          height=\"50vh\"\n          fixed-header\n          hide-default-footer\n          dense\n        >\n          <template v-slot:top>\n            <v-toolbar flat color=\"white\">\n              <v-toolbar-title v-if=\"!$vuetify.breakpoint.xsOnly\"\n                >View Sessions</v-toolbar-title\n              >\n              <v-spacer></v-spacer>\n              <v-btn\n                @click=\"prevPayPeriod\"\n                :disabled=\"punchData.length == 0\"\n                color=\"primary\"\n                >Previous</v-btn\n              >\n              <v-divider class=\"mx-4\" inset vertical></v-divider>\n              <v-btn\n                @click=\"nextPayPeriod\"\n                :disabled=\"payPeriodNumber == latestPayPeriod\"\n                color=\"primary\"\n                >Next</v-btn\n              >\n            </v-toolbar>\n          </template>\n        </v-data-table>\n      </div>\n      <div class=\"d-flex mt-4\">\n        <v-btn\n          :width=\"$vuetify.breakpoint.xsOnly ? '50%' : '200px'\"\n          @click=\"punchClock()\"\n          x-large\n          :loading=\"buttonsLoading\"\n          :disabled=\"buttonsLoading\"\n          :color=\"clockStatus == 'out' ? 'green' : 'red'\"\n          class=\"mx-auto\"\n        >\n          {{ clockStatus === 'out' ? 'Clock In' : 'Clock Out' }}\n        </v-btn>\n      </div>\n\n      <div class=\"d-flex\">\n        <v-card elevation=\"2\" class=\"mx-auto mt-4\">\n          <v-card-text class=\"black--text\">\n            <div>Amount Earned: ${{ amountEarned.toFixed(2) }}</div>\n          </v-card-text>\n        </v-card>\n      </div>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport _ from 'lodash';\nimport moment from 'moment';\n\nexport default {\n  name: 'Clock',\n  computed: {\n    isLoggedIn() {\n      return this.$store.getters.isLoggedIn;\n    },\n    payPeriodEnd() {\n      return moment(this.payPeriodBegin)\n        .add(2, 'weeks')\n        .subtract(1, 'second')\n        .toDate();\n    },\n  },\n  data() {\n    return {\n      clockStatus: '',\n      punchData: [],\n      tableLoading: true,\n      buttonsLoading: true,\n      originPayPeriodBegin: new Date('September 5, 2020 00:00:00'),\n      payPeriodBegin: null,\n      payPeriodNumber: 0,\n      amountEarned: 0,\n      latestPayPeriod: 0,\n      headers: [\n        { text: 'In Time', value: 'intime', groupable: false },\n        { text: 'Out Time', value: 'outtime', groupable: false },\n        { text: 'Date', value: 'date', groupable: false },\n        { text: 'Hours', value: 'hours', groupable: false },\n      ],\n    };\n  },\n  mounted() {\n    this.getClockStatus();\n    this.getCurrentPayPeriod();\n  },\n  watch: {\n    async payPeriodEnd() {\n      await this.getSessions();\n    },\n  },\n  methods: {\n    async getCurrentPayPeriod() {\n      this.payPeriodBegin = moment(\n        this.originPayPeriodBegin,\n      ).toDate();\n      let now = moment();\n      this.payPeriodNumber = Math.floor(\n        moment\n          .duration(now.diff(moment(this.originPayPeriodBegin)))\n          .asWeeks() / 2,\n      );\n      this.latestPayPeriod = this.payPeriodNumber;\n\n      this.goToPayPeriod(this.latestPayPeriod);\n\n      this.tableLoading = false;\n    },\n    nextPayPeriod() {\n      this.payPeriodNumber++;\n      this.payPeriodBegin = moment(this.originPayPeriodBegin)\n        .add(2 * this.payPeriodNumber, 'weeks')\n        .toDate();\n    },\n    prevPayPeriod() {\n      this.payPeriodNumber--;\n      this.payPeriodBegin = moment(this.originPayPeriodBegin)\n        .add(2 * this.payPeriodNumber, 'weeks')\n        .toDate();\n    },\n    goToPayPeriod(goto = this.latestPayPeriod) {\n      this.payPeriodNumber = goto;\n      this.payPeriodBegin = moment(this.originPayPeriodBegin)\n        .add(2 * this.payPeriodNumber, 'weeks')\n        .toDate();\n    },\n    async getSessions() {\n      const sessions = await this.$axios.get(\n        'account/clock/getSessions',\n        {\n          params: {\n            payPeriodBegin: this.payPeriodBegin,\n            payPeriodEnd: this.payPeriodEnd,\n          },\n        },\n      );\n      this.amountEarned = 0;\n      _.forEach(sessions.data, session => {\n        session.dateObjIn = session.intime;\n        session.date = moment(session.intime).format(\n          'dddd, MMM Do YYYY',\n        );\n\n        if (session.outtime) {\n          session.outtime = moment(session.outtime).format(\n            'hh:mm:ss A',\n          );\n          let computedHours = new Date(null);\n          computedHours.setSeconds(session.secondsworked);\n          session.hours = computedHours.toISOString().substr(11, 8);\n          this.amountEarned +=\n            (session.secondsworked / 3600) * session.payrate;\n        }\n        session.intime = moment(session.intime).format('hh:mm:ss A');\n      });\n\n      this.punchData = sessions.data;\n    },\n    async getClockStatus() {\n      try {\n        const { data = {} } = await this.$axios.get(\n          '/account/clock/status',\n        );\n        const clockStatus = data;\n        this.clockStatus = clockStatus;\n      } catch (error) {\n        console.log('getClockStatus -> error', error);\n      }\n      this.buttonsLoading = false;\n    },\n\n    async punchClock() {\n      this.buttonsLoading = true;\n\n      try {\n        await this.$axios.post('/account/clock/punch');\n        this.getClockStatus();\n      } catch (error) {\n        console.log('punchClock -> error', error);\n      }\n      this.getCurrentPayPeriod();\n    },\n  },\n};\n</script>\n"]}]}