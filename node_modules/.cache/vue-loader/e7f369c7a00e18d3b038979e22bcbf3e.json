{"remainingRequest":"/home/wesam/Code/CMS/cms-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wesam/Code/CMS/cms-ui/src/views/Clock.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wesam/Code/CMS/cms-ui/src/views/Clock.vue","mtime":1599451223682},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wesam/Code/CMS/cms-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gImxvZGFzaCI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2xvY2siLAogIGNvbXB1dGVkOiB7CiAgICBpc0xvZ2dlZEluKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5pc0xvZ2dlZEluOwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNsb2NrU3RhdHVzOiAiIiwKICAgICAgcHVuY2hEYXRhOiBbXSwKICAgICAgYW1vdW50RWFybmVkOiAwLAogICAgICBzZWFyY2g6ICIiLAogICAgICBoZWFkZXJzOiBbCiAgICAgICAgewogICAgICAgICAgdGV4dDogIklEIiwKICAgICAgICAgIGFsaWduOiAic3RhcnQiLAogICAgICAgICAgdmFsdWU6ICJpZCIsCiAgICAgICAgICBncm91cGFibGU6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICB7IHRleHQ6ICJJbiBUaW1lIiwgdmFsdWU6ICJpbnRpbWUiLCBncm91cGFibGU6IGZhbHNlIH0sCiAgICAgICAgeyB0ZXh0OiAiT3V0IFRpbWUiLCB2YWx1ZTogIm91dHRpbWUiLCBncm91cGFibGU6IGZhbHNlIH0sCiAgICAgICAgeyB0ZXh0OiAiRGF0ZSIsIHZhbHVlOiAiZGF0ZSIsIGdyb3VwYWJsZTogZmFsc2UgfSwKICAgICAgICB7IHRleHQ6ICJIb3VycyIsIHZhbHVlOiAiaG91cnMiLCBncm91cGFibGU6IGZhbHNlIH0KICAgICAgXQogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldFNlc3Npb25zKCk7CiAgICB0aGlzLmdldENsb2NrU3RhdHVzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBnZXRTZXNzaW9ucygpIHsKICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCB0aGlzLiRheGlvcy5nZXQoImFjY291bnQvY2xvY2svZ2V0U2Vzc2lvbnMiKTsKICAgICAgdGhpcy5hbW91bnRFYXJuZWQgPSAwOyAvLyBUT0RPOiByZXdvcmsgZWFybmluZ3MgbWVjaGFuaXNtCiAgICAgIF8uZm9yRWFjaChzZXNzaW9ucy5kYXRhLCBzZXNzaW9uID0+IHsKICAgICAgICBzZXNzaW9uLmRhdGUgPSBtb21lbnQoc2Vzc2lvbi5pbnRpbWUpLmZvcm1hdCgiZGRkZCwgTU1NIERvIFlZWVkiKTsKICAgICAgICAKICAgICAgICBpZihzZXNzaW9uLm91dHRpbWUpIHsKICAgICAgICAgIHNlc3Npb24ub3V0dGltZSA9IG1vbWVudChzZXNzaW9uLm91dHRpbWUpLmZvcm1hdCgiaGg6bW06c3MgQSIpOwogICAgICAgICAgbGV0IGNvbXB1dGVkSG91cnMgPSBuZXcgRGF0ZShudWxsKTsKICAgICAgICAgIGNvbXB1dGVkSG91cnMuc2V0U2Vjb25kcyhzZXNzaW9uLnNlY29uZHN3b3JrZWQpOwogICAgICAgICAgc2Vzc2lvbi5ob3VycyA9IGNvbXB1dGVkSG91cnMudG9JU09TdHJpbmcoKS5zdWJzdHIoMTEsIDgpOwogICAgICAgICAgdGhpcy5hbW91bnRFYXJuZWQgKz0gc2Vzc2lvbi5zZWNvbmRzd29ya2VkLzM2MDAgKiBzZXNzaW9uLnBheXJhdGU7CiAgICAgICAgfQogICAgICAgIHNlc3Npb24uaW50aW1lID0gbW9tZW50KHNlc3Npb24uaW50aW1lKS5mb3JtYXQoImhoOm1tOnNzIEEiKTsKICAgICAgfSk7CgogICAgICB0aGlzLnB1bmNoRGF0YSA9IHNlc3Npb25zLmRhdGE7CiAgICB9LAogICAgZ2V0QnV0dG9uVGV4dCgpIHsKICAgICAgaWYgKHRoaXMuY2xvY2tTdGF0dXMgPT0gImluIikgcmV0dXJuICJDbG9jayBPdXQiOwogICAgICBlbHNlIHJldHVybiAiQ2xvY2sgSW4iOwogICAgfSwKICAgIGFzeW5jIGdldENsb2NrU3RhdHVzKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHsgZGF0YSA9IHt9IH0gPSBhd2FpdCB0aGlzLiRheGlvcy5nZXQoIi9hY2NvdW50L2Nsb2NrL3N0YXR1cyIpOwogICAgICAgIGNvbnN0IGNsb2NrU3RhdHVzID0gZGF0YTsKICAgICAgICB0aGlzLmNsb2NrU3RhdHVzID0gY2xvY2tTdGF0dXM7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coImdldENsb2NrU3RhdHVzIC0+IGVycm9yIiwgZXJyb3IpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIHB1bmNoQ2xvY2soKSB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgiL2FjY291bnQvY2xvY2svcHVuY2giKTsKICAgICAgICB0aGlzLmdldENsb2NrU3RhdHVzKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coInB1bmNoQ2xvY2sgLT4gZXJyb3IiLCBlcnJvcik7CiAgICAgIH0KICAgICAgdGhpcy5nZXRTZXNzaW9ucygpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["Clock.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Clock.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <v-row class=\"justify-center\">\n    <v-col cols=\"12\">\n        <div>\n          <v-data-table\n            :headers=\"headers\"\n            :items=\"punchData\"\n            item-key=\"id\"\n            :sortBy=\"['id']\"\n            :sort-desc=\"[true]\"\n            :search=\"search\"\n            :mobile-breakpoint=\"0\"\n            multi-sort\n            height=\"50vh\"\n            fixed-header\n            hide-default-footer\n            show-group-by\n            :items-per-page=\"200\"\n            dense\n          ></v-data-table>\n        </div>\n        <div>\n          <v-card-text>\n            <v-text-field\n              v-model=\"search\"\n              append-icon=\"mdi-magnify\"\n              label=\"Search\"\n              single-line\n              hide-details\n            ></v-text-field>\n          </v-card-text>\n        </div>\n\n      <div class=\"d-flex\">\n        <v-btn\n          width=\"50%\"\n          @click=\"punchClock()\"\n          x-large\n          dark\n          color=\"black\"\n          class=\"mx-auto\"\n        >\n          {{ getButtonText() }}\n        </v-btn>\n      </div>\n      <div class=\"d-flex\">\n        <v-card elevation=2 class=\"mx-auto mt-4\">\n          <v-card-text class=\"black--text\">\n            <div>Amount Earned: ${{ amountEarned.toFixed(2) }}</div>\n          </v-card-text>\n        </v-card>\n      </div>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport _ from \"lodash\";\nimport moment from \"moment\";\n\nexport default {\n  name: \"Clock\",\n  computed: {\n    isLoggedIn() {\n      return this.$store.getters.isLoggedIn;\n    }\n  },\n  data() {\n    return {\n      clockStatus: \"\",\n      punchData: [],\n      amountEarned: 0,\n      search: \"\",\n      headers: [\n        {\n          text: \"ID\",\n          align: \"start\",\n          value: \"id\",\n          groupable: false\n        },\n        { text: \"In Time\", value: \"intime\", groupable: false },\n        { text: \"Out Time\", value: \"outtime\", groupable: false },\n        { text: \"Date\", value: \"date\", groupable: false },\n        { text: \"Hours\", value: \"hours\", groupable: false }\n      ]\n    };\n  },\n  mounted() {\n    this.getSessions();\n    this.getClockStatus();\n  },\n  methods: {\n    async getSessions() {\n      const sessions = await this.$axios.get(\"account/clock/getSessions\");\n      this.amountEarned = 0; // TODO: rework earnings mechanism\n      _.forEach(sessions.data, session => {\n        session.date = moment(session.intime).format(\"dddd, MMM Do YYYY\");\n        \n        if(session.outtime) {\n          session.outtime = moment(session.outtime).format(\"hh:mm:ss A\");\n          let computedHours = new Date(null);\n          computedHours.setSeconds(session.secondsworked);\n          session.hours = computedHours.toISOString().substr(11, 8);\n          this.amountEarned += session.secondsworked/3600 * session.payrate;\n        }\n        session.intime = moment(session.intime).format(\"hh:mm:ss A\");\n      });\n\n      this.punchData = sessions.data;\n    },\n    getButtonText() {\n      if (this.clockStatus == \"in\") return \"Clock Out\";\n      else return \"Clock In\";\n    },\n    async getClockStatus() {\n      try {\n        const { data = {} } = await this.$axios.get(\"/account/clock/status\");\n        const clockStatus = data;\n        this.clockStatus = clockStatus;\n      } catch (error) {\n        console.log(\"getClockStatus -> error\", error);\n      }\n    },\n\n    async punchClock() {\n      try {\n        await this.$axios.post(\"/account/clock/punch\");\n        this.getClockStatus();\n      } catch (error) {\n        console.log(\"punchClock -> error\", error);\n      }\n      this.getSessions();\n    }\n  }\n};\n</script>\n"]}]}